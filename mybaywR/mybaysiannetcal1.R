mybay <- read.delim("C:/Users/Kazem Kamrani/Desktop/Bayesian Networks with Examples in R/mybaywR/mybay.txt")
library(bnlearn)
library(MASS)
library(rbmn)
library(Rgraphviz)
mynet  <- empty.graph(nodes = c("A", "D", "E", "G", "S", "EN", "EI", "FI", "FS", "WFENI", "WI"))
arc.set <- matrix(c("A", "WI",
                    "D", "WI",
                    "E", "WI",
                    "A", "S",
                    "D", "S",
                    "E", "S", 
                    "S", "G",
                    "A", "EN",
                    "D", "EN",
                    "E", "EN",
                    "WI", "WFENI",
                    "S", "FS",
                    "EN", "EI",
                    "G", "EN",
                    "FS", "FI",
                    "FS", "WI",
                    "FS", "EI",
                    "FI", "WFENI",
                    "EI", "WFENI"),
                  byrow = TRUE, ncol = 2,
                  dimnames = list(NULL, c("from", "to")))
arcs(mynet) <- arc.set

MyPlot=graphviz.plot(mynet)

mybn=bn.fit(mynet,mybay)


my.bn.par.rbmn <- bnfit2nbn(mybn)
print8nbn(my.bn.par.rbmn)
my.bn.par.mn <- nbn2mn(my.bn.par.rbmn)

names <- c("A", "D", "E", "G", "S", "EN", "EI", "FI", "FS", "WFENI", "WI")
obsnames <- c("A", "D", "E" )

obsval1 <- c(97.15842491,5.857142857,3.816533786)
obsval2 <- c(100,5,0)
obsval3 <- c(97.99592075,10.07142857,4.738744318)
obsval4 <- c(63.28627947,28.08,34.93676507)
obsval5 <- c(27.29281877,7.607142857,6.62561727)
obsval6 <- c(23.38893211,7.785714286,3.335440375)
obsval7 <- c(69.90533945,19.12,37.59721176)
obsval8 <- c(91.34497134,6.571428571,7.093845299)
obsval9 <- c(99.70862471,9.214285714,1.05448117)
obsval10 <- c(23.44778344,29.85714286,44.97039254)
obsval11 <- c(95.52894328,10.71428571,7.537532739)
obsval12 <- c(68.96472227,19.36,37.34126516)
obsval13 <- c(13.14509708,23.78571429,100)
obsval14 <- c(90.30836906,6.714285714,6.493172372)
obsval15 <- c(67.66305108,11.75,64.10287552)
obsval16 <- c(92.66916417,11.14285714,10.61530299)
obsval17 <- c(20.97935775,30.71428571,51.87963626)
obsval18 <- c(15.77302367,24,100)
obsval19 <- c(64.32898916,19.8,35.58630584)
obsval20 <- c(94.63966589,10.92857143,8.25459025)
obsval21 <- c(30.17822817,7.428571429,6.825005738)
obsval22 <- c(63.38637413,20,36.67059723)
obsval23 <- c(32.92573199,7.25,5.583076424)
obsval24 <- c(89.78649129,11.57142857,13.10227237)
obsval25 <- c(91.95538749,6.428571429,7.347675839)
obsval26 <- c(25.46410397,29.28571429,44.52165953)
obsval27 <- c(25.16375886,21.64285714,45.20213874)
obsval28 <- c(59.20878903,12.25,78.32927365)
obsval29 <- c(40.83684147,6.892857143,3.87878974)
obsval30 <- c(15.89798828,31.85714286,87.61958239)
obsval31 <- c(89.32735008,6.857142857,7.515224058)
obsval32 <- c(20.051835,22.71428571,67.28550391)
obsval33 <- c(26.01767691,21.42857143,45.36428428)
obsval34 <- c(47.66047722,12.5,100)
obsval35 <- c(13.48632686,8.5,5.433798274)
obsval36 <- c(78.23331222,10.5,46.83507187)
obsval37 <- c(26.52798596,29,44.28667436)
obsval38 <- c(68.38263507,19.42,36.56667207)
obsval39 <- c(64.10256685,12,69.23111315)
obsval40 <- c(61.32169324,28.86,35.51072451)
obsval41 <- c(14.64617854,32.14285714,96.55245922)
obsval42 <- c(24.68900525,21.85714286,45.32154101)
obsval43 <- c(100,9,0)
obsval44 <- c(99.10839161,9.642857143,3.178787058)
obsval45 <- c(58.50730769,6,5.882688227)
obsval46 <- c(65.72310029,19.7,36.36604026)
obsval47 <- c(19.92646512,8.142857143,2.65064309)
obsval48 <- c(98.83158508,9.857142857,3.59131002)
obsval49 <- c(58.36232161,30,36.10642914)
obsval50 <- c(63.5585694,19.9,63.5585694)
obsval51 <- c(18.56250374,31.28571429,67.53844338)
obsval52 <- c(59.1407623,29.7,35.969332)
obsval53 <- c(68.9266126,19.24,35.53144878)
obsval54 <- c(31.53750147,22.07142857,51.10458338)
obsval55 <- c(94.36399711,6.285714286,6.552556643)
obsval56 <- c(96.02156177,10.5,7.182815155)
obsval57 <- c(62.82916208,28.26,35.09539394)
obsval58 <- c(90.66217116,11.35714286,11.88333479)
obsval59 <- c(96.83470696,6,4.044739629)
obsval60 <- c(59.9238011,29.4,35.79396904)
obsval61 <- c(13.39980432,32.42857143,100)
obsval62 <- c(95.63522589,6.142857143,5.607131824)
obsval63 <- c(18.53172241,22.92857143,78.18315424)
obsval64 <- c(17.47538728,8.321428571,1.547314966)
obsval65 <- c(17.20552616,31.57142857,78.37848985)
obsval66 <- c(22.78771174,30.14285714,45.65887119)
obsval67 <- c(86.48706849,11.78571429,16.63946337)
obsval68 <- c(67.0028539,19.62,37.08084385)
obsval69 <- c(74.88895019,11,51.82870623)
obsval70 <- c(97.4490232,5.714285714,3.837556786)
obsval71 <- c(29.14156788,30.42857143,50.5811733)
obsval72 <- c(69.76305986,19.18,36.46358367)
obsval73 <- c(42.17118792,13,100)
obsval74 <- c(42.26376536,12.75,100)
obsval75 <- c(31.72466433,13.5,100)
obsval76 <- c(12.18012019,32.71428571,100)
obsval77 <- c(22.65810606,22.28571429,51.38234835)
obsval78 <- c(98.75457875,5.428571429,3.116274503)
obsval79 <- c(69.86131692,19.06,37.62295545)
obsval80 <- c(63.52830887,27.54,35.2404956)
obsval81 <- c(97.05574981,10.28571429,6.130130259)
obsval82 <- c(24.45869513,13.75,100)
obsval83 <- c(98.46611722,5.571428571,3.175346603)
obsval84 <- c(85.4007659,12,16.84792417)
obsval85 <- c(63.83170096,27.18,34.98113962)
obsval86 <- c(43.58186499,6.714285714,4.757521227)
obsval87 <- c(67.54806437,19.54,35.14670435)
obsval88 <- c(62.37384457,28.44,35.2137201)
obsval89 <- c(61.92163078,28.62,35.30943261)
obsval90 <- c(19.84105823,31,58.21656626)
obsval91 <- c(50.70951239,6.357142857,2.242704682)
obsval92 <- c(15.71250534,23.35714286,96.56510145)
obsval93 <- c(28.69255763,21,43.82944946)
obsval94 <- c(36.67483055,7.071428571,4.116954355)
obsval95 <- c(22.48855414,7.964285714,1.281735243)
obsval96 <- c(100,5.142857143,0)

prednames <- setdiff(names, obsnames)

print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval1))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval2))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval3))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval4))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval5))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval6))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval7))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval8))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval9))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval10))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval11))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval12))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval13))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval14))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval15))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval16))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval17))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval18))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval19))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval20))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval21))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval22))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval23))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval24))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval25))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval26))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval27))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval28))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval29))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval30))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval31))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval32))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval33))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval34))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval35))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval36))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval37))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval38))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval39))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval40))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval41))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval42))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval43))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval44))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval45))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval46))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval47))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval48))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval49))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval50))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval51))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval52))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval53))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval54))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval55))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval56))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval57))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval58))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval59))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval60))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval61))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval62))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval63))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval64))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval65))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval66))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval67))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval68))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval69))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval70))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval71))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval72))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval73))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval74))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval75))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval76))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval77))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval78))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval79))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval80))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval81))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval82))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval83))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval84))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval85))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval86))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval87))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval88))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval89))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval90))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval91))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval92))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval93))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval94))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval95))
print8mn(condi4joint(my.bn.par.mn, par = prednames, pour = obsnames, x2 = obsval96))









